#!/bin/sh
#
#       E - F (topic)
#      /
# A - B - C - D (master)
#
# "git_merge_diff topic master" shows B->F diff

TOPIC=$1
BASE=$2

if [ -z "${BASE}" ]; then
  # Auto-detect main branch (main or master)
  if git rev-parse --verify main >/dev/null 2>&1; then
    BASE="main"
  else
    BASE="master"
  fi
fi

exec git diff $(git merge-base ${TOPIC} ${BASE})..${TOPIC}
